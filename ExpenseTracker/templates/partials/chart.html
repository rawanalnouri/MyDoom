<div id="container{{num}}" style="width: 100%">
  <canvas id="chart{{num}}"></canvas>
</div>

<p> picked categories {{filtered}} </p>

<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
<script>
  var config = {
    type: "{{ type }}",
    data: {
      datasets: [
        {
          data: {{ data|safe }},
          backgroundColor: [
            "#7DD3E8",
            "#54B2CA",
            "#2D8EA6",
            "#C0C0C0",
            "#D3D3D3",
          ],
          label: "Percentage of budget",
        },
      ],
      labels: {{ labels|safe }}
    },
    options: {

      responsive: true,
      {% if type == 'doughnut' %}

      legend: {
      display: false
      }
      {% endif %}
      {% if type == 'pie' %}

      legend: {
        position: 'bottom'
      }
      {% endif %}
      {% if type == 'bar' %}
      legend: {
      display: false
    },
      scales: {
        yAxes: [{
            display: true,
            scaleLabel: {
            display: true,
            labelString: 'Budget used (%)'
          },
            ticks: {
                beginAtZero: true,   // minimum value will be 0.
                max: 100
            }
        }]
      }
    {% endif %}
    {% if type == 'polarArea' %}
      scale: {
        ticks: {
          min: 0,
          max: 100
        }
      }
    {% endif %}
    },
  };
  {% if type == 'doughnut' %}
  Chart.pluginService.register({
  beforeDraw: function(chart) {
    var width = chart.chart.width,
        height = chart.chart.height,
        ctx = chart.chart.ctx;
    ctx.restore();
    var fontSize = (height / 114).toFixed(2);
    ctx.font = fontSize + "em sans-serif";
    ctx.textBaseline = "middle";
    var text = "{{category.name}}",
        textX = Math.round((width - ctx.measureText(text).width) / 2),
        textY = height / 2;
    ctx.fillText(text, textX, textY);
    ctx.save();
  }
});
 {% endif %}

  const myChart{{num}} = new Chart(
  document.getElementById('chart{{num}}'),
  config
);

</script>
