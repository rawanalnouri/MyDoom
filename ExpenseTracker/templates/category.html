{% extends 'base.html' %}

{% block title %}{{category.name}}{% endblock %}

{% block content %}
    <h3 id="category-header">{{ category.name }} 
        <button id="openEditCategoryFormModal" class="btn btn-secondary"><i class="bi bi-pencil"></i></i> Edit Category</button>
        <button id="openExpenditureFormModal" class="btn btn-secondary"><i class="bi bi-plus-lg"></i> Create Expenditure</button>
    </h3>
    <p><b>Spending Limit</b> {{ category.spending_limit }}</p>
    <hr>
    <p><b>Expenditure History</b></p>
    <div class="shadow-4 rounded-3 overflow-hidden">
        <table class="table align-middle bg-white">
            <thead class="bg-light">
                <tr>
                    <th>Title</th>
                    <th>Amount</th>
                    <th>Mood</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                {% for expenditure in expenditures %}
                    <tr>
                        <td>{{ expenditure.title }}</td>
                        <td class="text-muted">-Â£{{ expenditure.amount }}</td>
                        {% include 'partials/moodColors.html' with mood=expenditure.mood %}
                        <td class="text-muted">{{ expenditure.date }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="text-center">
        {% if expenditures.has_previous %}
            <a href="?page={{ expenditures.previous_page_number }}">previous</a>
        {% endif %}
        page {{ expenditures.number }} of {{ expenditures.paginator.num_pages }}
        {% if expenditures.has_next %}
            <a href="?page={{ expenditures.next_page_number }}">next</a>
        {% endif %}
    </div>
   {% include 'modals/createExpenditure.html' with form=expenditureForm %} 
    <script>
        $(document).ready(function() {
            $("#openExpenditureFormModal").on("click", function() {
                $("#expenditureFormModal").modal("show");
            });
        });
    </script>   
    {% include 'modals/editCategory.html' with form=editCategoryForm %} 
    <script>
        $(document).ready(function() {
            $("#openEditCategoryFormModal").on("click", function() {
                $("#editCategoryFormModal").modal("show");
            });
        });
    </script>  
{% endblock %}